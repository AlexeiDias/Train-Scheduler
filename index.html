<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <!-- Firebase References -->
  <script src="https://www.gstatic.com/firebasejs/6.0.4/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.0.4/firebase-database.js"></script>
  <!-- Link to Moment.js should go here -->
  <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>

  <title>Train Scheduler</title>
</head>

<body>
  <div class="row">
    <div class="col-sm-2"></div>
    <div class="col-sm-8">
      <div class="jumbotron jumbotron-fluid">
        <div class="container text-center">
          <h1 class="display-4">Anytime is a Train Time</h1>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-2"></div>
    <div class="col-sm-8">
      <div class="card">
        <div class="card-header">
          Current Train Schedulle

        </div>
        <div class="card-body">
          <table class="table table-sm table-hover" id='employee-table'>
            <thead>
              <tr>
                <th scope="col">Train Name</th>
                <th scope="col">Destination</th>
                <th scope="col">Frequency (min)</th>
                <th scope="col">Next Arrival</th>
                <th scope="col">Minutes Away</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>

        </div>
      </div>
    </div>
    <div class="col-sm-2"></div>
  </div>
  <br>
  <div class="row">
    <div class="col-sm-2"></div>
    <div class="col-sm-8">
      <div class="card">
        <div class="card-header">
          Add Train
        </div>
        <div class="card-body">
          <form>
            <div class="form-group">
              <label for="train-name">Train Name</label>
              <input type="text" class="form-control" id="input-train" placeholder="">
            </div>
            <div class="form-group">
              <label for="destination">Destinatiomn</label>
              <input type="text" class="form-control" id="input-destination" placeholder="">
            </div>
            <div class="form-group">
              <label for="train-time">First Train Time</label>
              <input type="text" class="form-control" id="train-time" placeholder="HH:mm - military tinme">
            </div>
            <div class="form-group">
              <label for="frequency">Frequency</label>
              <input type="text" class="form-control" id="input-frequency" placeholder="(min)">
            </div>
            <button type="submit" id="submit" class="btn btn-primary">Submit</button>
          </form>
        </div>
      </div>
    </div>
    <div class="col-sm-2"></div>
  </div>
  <script>

     // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyAAAPRsS6JnfsWK-Fhz4ioHxP5zRNIvBfQ",
    authDomain: "alexei-930cb.firebaseapp.com",
    databaseURL: "https://alexei-930cb.firebaseio.com",
    projectId: "alexei-930cb",
    storageBucket: "",
    messagingSenderId: "856201311867",
    appId: "1:856201311867:web:0c4f145a7cf5526f6854de"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

    
    var dataRef = firebase.database();

    



    //declare variables that will hold the imput of each rext field
    $("#submit").on("click", function (event) {
      event.preventDefault();
      var inputTrain = $("#input-train").val();
      console.log(inputTrain)
      var inputDestination = $("#input-destination").val();
      console.log(inputDestination)
      var firstTrain = $("#train-time").val();
      console.log(firstTrain)
      var inputFrequency = $("#input-frequency").val();
      console.log(inputFrequency)

      $("#input-train").val(" ");
      $("#input-destination").val(" ");
      $("#train-time").val(" ");
      $("#input-frequency").val(" ");

 // Code for the push
 dataRef.ref().push({
      inputTrain: inputTrain,
      inputDestination: inputDestination,
      firstTrain: firstTrain,
      inputFrequency: inputFrequency,
      });

    });

    // Firebase watcher + initial loader HINT: .on("value")
    dataRef.ref().on("child_added", function(snapshot) {
      // Log everything that's coming out of snapshot
      console.log(snapshot.val());
      console.log(snapshot.val().inputTrain);
      console.log(snapshot.val().inputDestination);
      console.log(snapshot.val().firstTrain);
      console.log(snapshot.val().inputFrequency);
      console.log("hi");
    // });

    // Assumptions
    var tFrequency = 3;
    

    // Time is 3:30 AM
    var firstTime = "3:30";

    // First Time (pushed back 1 year to make sure it comes before current time)
    var firstTimeConverted = moment(firstTime, "HH:mm").subtract(1, "years");
    console.log(firstTimeConverted);

    // Current Time
    var currentTime = moment();
    console.log("CURRENT TIME: " + moment(currentTime).format("hh:mm"));

    // Difference between the times
    var diffTime = moment().diff(moment(firstTimeConverted), "minutes");
    console.log("DIFFERENCE IN TIME: " + diffTime);

    // Time apart (remainder)
    var tRemainder = diffTime % tFrequency;
    console.log(tRemainder);

    // Minute Until Train
    var tMinutesTillTrain = tFrequency - tRemainder;
    console.log("MINUTES TILL TRAIN: " + tMinutesTillTrain);

    // Next Train
    var nextTrain = moment().add(tMinutesTillTrain, "minutes");
    console.log("ARRIVAL TIME: " + moment(nextTrain).format("hh:mm"));
    
  });
    
    // var m = moment();
    // console.log(m.toString());

    // console.log(m.minutes());

    // console.log(m.hour());

    // console.log(m.week());

    // m.minutes(52);
    // m.hour(14);
    // m.week(4);
    // m.day("day", 4);

    // console.log(m.toString());

    // var m = firstTrain;


    // console.log(m.toString());
    //   m.add({
    //     "hours": 7,
    //     "minutes": 15
    //   });
    // console.log(m.toString());




    

      // listen for a click of the submit button to capture the user imput vallues

      //assign the values of each imput text field to its variables

      // empy the text field

      // imput of firebase key

      // inicialize firebase

      // send variable values to firebase

      // take a snapshot of the variables and send to firebase

      // crate new vallues and child snapshot 

      // use moment js to calculate time

      // and assing to new variables

      //dynamicaly create new rows to append vallues of the variables with the firebase snapshot









  </script>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->

</body>

</html>